# CVE-2016-4622

It seems that the 2.6.2+dfsg1-4 Debian's package (from jessie distribution is vulnerable) but in reality
could be the 2.12.3-1 (looking directly to the source code log)

The git url is the following

```
$ git clone https://salsa.debian.org/webkit-team/webkit webkit-debian && cd webkit-debian
```

but seems convenient to download directly from a container running ``jessie``

```
$ docker run -v $PWD:/webkit -it debian:jessie /bin/bash
root@5303a3f8a009:/# apt-get update
 <enable source package in sources.list>
root@5303a3f8a009:/# apt-get source webkit2gtk
root@5303a3f8a009:/# apt-get build-dep webkit2gtk
$ docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
5303a3f8a009        debian:jessie       "/bin/bash"              12 minutes ago      Up 12 minutes                                practical_kowalevski
$ docker commit 5303a3f8a009 gipi/webkit-debian-build
$ docker run -v $PWD:/webkit --user 1000:1000 -it gipi/webkit-debian-build /bin/bash
I have no name!@2a9ab4aef631:/webkit2gtk-2.6.2+dfsg1$ debuild -b -uc -us --no-pre-clean -j3
 <like three coffes later>
I have no name!@2a9ab4aef631:/webkit/webkit2gtk-2.6.2+dfsg1$ apt-cache rdepends libwebkit2gtk-4.0-37
libwebkit2gtk-4.0-37
Reverse Depends:
  libwebkit2gtk-4.0-dev
  libwebkit2gtk-4.0-37-dbg
  gir1.2-webkit2-4.0
  epiphany-browser
```

So you can test the vulnerability in Linux using ``epiphany-browser`` as client for WebKit:
if all is ok you can obtain the following output from the PoC linked below

```
[*] Setting up container object
[*] Fake JSObject @ 0x00007fd56c9fc7d0
[*] Float64Array structure ID found: 00001000
[<] Reading 8 bytes from 0x00007fd56f5da100
[>] Writing 8 bytes to 0x00007fd56c9fc7c0
[<] Reading 16 bytes from 0x00007fd56c9ea380
[>] Writing 16 bytes to 0x00007fd56c9fc7d0
[>] Writing 8 bytes to 0x00007fd56c9fc7e8
[+] All done!
[+] Shellcode function object @ 0x00007fd56c9e10c0
[<] Reading 8 bytes from 0x00007fd56c9e10d8
[+] Executable instance @ 0x00007fd56f585e60
[<] Reading 8 bytes from 0x00007fd56f585e70
[+] JITCode instance @ 0x00007fd56cd64a78
[<] Reading 8 bytes from 0x00007fd56cd64a98
[+] RWX memory @ 0x00007fd570006669
[+] Writing shellcode...
[>] Writing 3 bytes to 0x00007fd570006669
[!] Jumping into shellcode...
```

## Links

 - [Phrack article](http://phrack.com/papers/attacking_javascript_engines.html)
 - [PoC](https://github.com/saelo/jscpwn)
 - [Debian security tracker](https://security-tracker.debian.org/tracker/CVE-2016-4622)
 - [Debian gitlab repo](https://salsa.debian.org/webkit-team/webkit)
