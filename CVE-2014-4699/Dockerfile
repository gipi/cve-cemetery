# Dockerfile to build linux-image-3.2.0-23-generic with debug symbols
from ubuntu:12.04

RUN apt-get update
RUN apt-get install -y wget pkg-create-dbgsym
RUN apt-get build-dep -y linux-image-3.2.0-23-generic

RUN mkdir /archives
WORKDIR /archives

RUN wget --no-check-certificate https://launchpad.net/ubuntu/+archive/primary/+files/linux_3.2.0.orig.tar.gz
RUN wget --no-check-certificate https://launchpad.net/ubuntu/+archive/primary/+files/linux_3.2.0-23.36.diff.gz

WORKDIR /kernel/
CMD tar zxvf /archives/linux_3.2.0.orig.tar.gz && \
    gunzip /archives/linux_3.2.0-23.36.diff.gz && \
    cd linux-3.2 && \
    patch -p1 < /archives/linux_3.2.0-23.36.diff && \
    chmod +x debian/rules && chmod a+x debian/scripts/misc/* && \
    DEB_BUILD_OPTIONS=parallel=8 AUTOBUILD=1 NOEXTRAS=1 debian/rules binary-generic skipdbg=false

